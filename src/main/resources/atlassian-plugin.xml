<atlassian-plugin key="${atlassian.plugin.key}" name="${project.name}" plugins-version="2">
    <plugin-info>
        <description>${project.description}</description>
        <version>${project.version}</version>
        <vendor name="${project.organization.name}" url="${project.organization.url}" />
        <param name="plugin-icon">images/pluginIcon.png</param>
        <param name="plugin-logo">images/pluginLogo.png</param>
    </plugin-info>

    <!-- add our i18n resource -->
    <resource type="i18n" name="i18n" location="obermacros"/>
    
    <!-- add our web resources -->
    <web-resource key="obermacros-resources" name="obermacros web resources">
        <dependency>com.atlassian.auiplugin:ajs</dependency>
        
        <resource type="download" name="obermacros.css" location="/css/obermacros.css"/>
        <resource type="download" name="obermacros.js" location="/js/obermacros.js"/>
        <resource type="download" name="images/" location="/images"/>

        <resource type="download" name="js/oc.js" location="js/oc.js"/>



        <resource type="download" name="js/codemirror/oberon07.js" location="js/codemirror/oberon07.js"/>
        <resource type="download" name="js/jslibs/codemirror/codemirror.css" location="js/jslibs/codemirror/codemirror.css"/>
        <resource type="download" name="js/jslibs/codemirror/codemirror.js" location="js/jslibs/codemirror/codemirror.js"/>
        <resource type="download" name="js/jslibs/codemirror/javascript.js" location="js/jslibs/codemirror/javascript.js"/>
        <resource type="download" name="js/jslibs/processing/processing.js" location="js/jslibs/processing/processing.js"/>

        <context>obermacros</context>
    </web-resource>

    <resource name="view" type="html/text" location="templates/ober.vm"/>

    <!--    <user-macro name='obermacros' key='obermacros-macros' hasBody='true' bodyType='raw' outputType='html'>-->
<!--        <description>obermacro</description>-->
<!--        <template>-->
<!--            <![CDATA[-->

<!--                <td style="padding-left: 7px; font-size: 12pt;" valign="top"><div id="canvas"></div><div id="log" style="font-family: monospace;">&nbsp;&nbsp;1&nbsp;&nbsp;2&nbsp;&nbsp;3&nbsp;&nbsp;4&nbsp;&nbsp;5&nbsp;&nbsp;6&nbsp;&nbsp;7&nbsp;&nbsp;8&nbsp;&nbsp;9<br>&nbsp;&nbsp;2&nbsp;&nbsp;4&nbsp;&nbsp;6&nbsp;&nbsp;8&nbsp;10&nbsp;12&nbsp;14&nbsp;16&nbsp;18<br>&nbsp;&nbsp;3&nbsp;&nbsp;6&nbsp;&nbsp;9&nbsp;12&nbsp;15&nbsp;18&nbsp;21&nbsp;24&nbsp;27<br>&nbsp;&nbsp;4&nbsp;&nbsp;8&nbsp;12&nbsp;16&nbsp;20&nbsp;24&nbsp;28&nbsp;32&nbsp;36<br>&nbsp;&nbsp;5&nbsp;10&nbsp;15&nbsp;20&nbsp;25&nbsp;30&nbsp;35&nbsp;40&nbsp;45<br>&nbsp;&nbsp;6&nbsp;12&nbsp;18&nbsp;24&nbsp;30&nbsp;36&nbsp;42&nbsp;48&nbsp;54<br>&nbsp;&nbsp;7&nbsp;14&nbsp;21&nbsp;28&nbsp;35&nbsp;42&nbsp;49&nbsp;56&nbsp;63<br>&nbsp;&nbsp;8&nbsp;16&nbsp;24&nbsp;32&nbsp;40&nbsp;48&nbsp;56&nbsp;64&nbsp;72<br>&nbsp;&nbsp;9&nbsp;18&nbsp;27&nbsp;36&nbsp;45&nbsp;54&nbsp;63&nbsp;72&nbsp;81<br></div></td>-->


<!--                <div id="links">-->
<!--                    <p><a href="http://oberspace.dyndns.org">Home</a></p>-->
<!--                    <p><a href="https://github.com/vladfolts/oberonjs">Development</a></p>-->
<!--                </div>-->

<!--                <p>-->
<!--                <form action="">-->
<!--                Oberon module(s):-->
<!--                <input type="radio" name="compiler" value="oberon" checked>Oberon</input>-->
<!--                <input type="radio" name="compiler" value="eberon" id="eberon">-->
<!--                    <a href="https://github.com/vladfolts/oberonjs/wiki/Eberon">-->
<!--                    Eberon-->
<!--                    </a>-->
<!--                </input>-->
<!--                <p/>-->
<!--                <input type="checkbox" id="checkIndexesOption">checked indexes</input>-->
<!--                </form>-->
<!--                </p>-->

<!--                <div class="code">-->
<!--                <textarea id="source" rows="10" cols="80">-->
<!--                (*-->
<!--                MODULE test;-->
<!--                IMPORT JS;-->
<!--                BEGIN-->
<!--                    JS.alert("Hello, World!")-->
<!--                END test.-->
<!--                *)-->
<!--                $body-->
<!--                </textarea>-->
<!--                </div>-->

<!--                    <p>-->
<!--                        <button onclick="compile()">Compile</button>-->
<!--                        <button onclick="compile(); run()">Compile &amp; Run</button>-->
<!--                    </p>-->

<!--                <p id="compileErrors" style="color:red"></p>-->
<!--                <p id="compileTime"></p>-->

<!--                <div class="code">-->
<!--                <textarea id="result" rows="10" cols="80">-->
<!--                </textarea>-->
<!--                </div>-->
<!--                    <p><button onclick="run()">Run</button></p>-->
<!--                    <p><button onclick="run_tests()">Run Tests</button></p>-->
<!--                <p id="runErrors" style="color:red"></p>-->
<!--                <p id="runTime"></p>-->
<!--                <p id="testsResult"></p>-->
<!--                <p id="version"></p>-->

<!--                <script src="__ATLASSIAN_BASE_URL__/download/resources/nemavasi.confluence.obermacros:obermacros-resources/js/oc.js"></script>-->

<!--                <script>-->
<!--                    var oberonEditor = CodeMirror.fromTextArea(document.getElementById('source'), {-->
<!--                            lineNumbers: true,-->
<!--                            mode: "text/x-oberon07"-->
<!--                        });-->
<!--                    var javascriptEditor = CodeMirror.fromTextArea(document.getElementById('result'), {-->
<!--                        lineNumbers: true,-->
<!--                        mode: "text/javascript"-->
<!--                    });-->

<!--                    if (typeof buildVersion != "undefined")-->
<!--                        document.getElementById("version").textContent = buildVersion;-->

<!--                    function compile(){-->
<!--                        var src = oberonEditor.getValue();-->
<!--                        var result;-->
<!--                        var errors = "";-->
<!--                        var start = new Date();-->
<!--                        try {-->
<!--                            var language = require(-->
<!--                                document.getElementById("eberon").checked-->
<!--                                    ? "eberon/eberon_grammar.js"-->
<!--                                    : "oberon/oberon_grammar.js").language;-->
<!--                            var options = {checkIndexes: document.getElementById("checkIndexesOption").checked};-->
<!--                            result = require("oc.js").compile(-->
<!--                                    src,-->
<!--                                    language,-->
<!--                                    function(e){errors += e;},-->
<!--                                    options-->
<!--                                    );-->
<!--                            }-->
<!--                        catch (e) {-->
<!--                            errors += e;-->
<!--                            }-->
<!--                        var compileTime = (new Date() - start) / 1000;-->

<!--                        if (!result)-->
<!--                            result = "";-->
<!--                        javascriptEditor.setValue(result);-->
<!--                        document.getElementById("compileErrors").textContent = errors;-->
<!--                        document.getElementById("compileTime").textContent = "compile time (seconds): " + compileTime;-->
<!--                            }-->

<!--                        function timed_run(action){-->
<!--                            var start = new Date();-->
<!--                            var result = action();-->
<!--                            var runTime = (new Date() - start) / 1000;-->
<!--                            document.getElementById("runTime").textContent = "run time (seconds): " + runTime;-->
<!--                            return result;-->
<!--                        }-->

<!--                        function run(){-->
<!--                            var errElement = document.getElementById("runErrors");-->
<!--                            errElement.textContent = "";-->
<!--                            timed_run(function(){-->
<!--                                try{-->
<!--                                    eval(javascriptEditor.getValue());-->
<!--                                }-->
<!--                                catch (e){-->
<!--                                    var errors = "" + e;-->
<!--                                    errElement.textContent = errors;-->
<!--                                }-->
<!--                            });-->
<!--                        }-->

<!--                        function run_tests(){-->
<!--                            var resultsElement = document.getElementById("testsResult");-->
<!--                            resultsElement.textContent = "running...";-->
<!--                            var result = timed_run(function(){-->
<!--                                return require("test_unit.js").run();-->
<!--                            });-->
<!--                            resultsElement.textContent = result ? "Tests OK" : "Tests failed";-->
<!--                        }-->
<!--                </script>-->


<!--            ]]>-->
<!--        </template>-->
<!--        <parameters>-->
<!--            <parameter name="example" type="string"/>-->
<!--        </parameters>-->
<!--    </user-macro>-->

    <xhtml-macro name="obermacros" class="nemavasi.confluence.obermacros.obj.OberMacros" key='ober-macro' category="confluence-content">
        <description key="obermacros.description.desc"/>
        <parameters>
            <parameter name="width" type="int" />
            <parameter name="height" type="int" />
<!--            <parameter name="Color" type="enum">-->
<!--                <value name="red"/>-->
<!--                <value name="green"/>-->
<!--                <value name="blue"/>-->
<!--            </parameter>-->
        </parameters>
    </xhtml-macro>

    <rest name="obermacros rest" i18n-name-key="obermacros-rest.name" key="nemavasi-confluence-obermacros-rest" path="/obermacros_plugin" version="1.0">
        <description key="obermacros-rest.description">nemavasi-confluence-obermacros</description>
    </rest>

</atlassian-plugin>